import{a as Z}from"./chunk-TX7GZHKA.js";import{a as X}from"./chunk-5RTZGLF2.js";import{b as O,d as z,e as G,g as H,i as W,j as q,r as Y,t as $}from"./chunk-VYT3RLMY.js";import{a as J}from"./chunk-BA2J2MWB.js";import{a as ee}from"./chunk-4W5ANO5I.js";import{a as Q}from"./chunk-NLJOITTN.js";import{a as K}from"./chunk-PQ4VLYEJ.js";import{j as U,l as N}from"./chunk-LO4VKSRB.js";import{k as A,l as B,m as j,q as R,s as L}from"./chunk-YLYAE3YR.js";import{Ab as C,Cb as M,Db as F,Eb as D,Ga as V,Ka as r,Lb as S,Mb as I,Nb as k,Pa as v,Ua as T,Za as _,eb as m,ga as u,ha as g,hb as i,i as y,ia as h,ib as t,ja as E,jb as p,mb as w,pb as x,qb as s,xb as n,yb as b,za as P,zb as c}from"./chunk-FFU2WZLN.js";function ie(a,l){a&1&&(i(0,"div",2)(1,"div",3)(2,"div",4),p(3,"div",5),i(4,"div",6),h(),i(5,"svg",7),p(6,"path",8),t()()(),E(),i(7,"p",9),n(8," \u{1F4E6} Loading your inventory... "),t(),i(9,"div",10),p(10,"div",11),t()()())}function ne(a,l){if(a&1){let e=w();i(0,"li",50)(1,"button",51),x("click",function(){let o=u(e).$implicit,f=s(2);return g(f.setActiveTab(o.id))}),p(2,"i",52),n(3),t()()}if(a&2){let e=l.$implicit,d=s(2);r(),m("ngClass",d.activeTab===e.id?"bg-green-100 text-green-700 border-b-2 border-green-600":"text-gray-600 hover:text-green-600 hover:bg-green-50"),r(),m("ngClass",e.icon+" mr-2"),r(),c(" ",e.label," ")}}function re(a,l){if(a&1&&(i(0,"div")(1,"div",53)(2,"ul",54)(3,"li")(4,"strong"),n(5,"Quantity:"),t(),n(6),t(),i(7,"li")(8,"strong"),n(9,"Total Price:"),t(),i(10,"span",55),n(11),t()(),i(12,"li")(13,"strong"),n(14,"Status:"),t(),n(15),t(),i(16,"li")(17,"strong"),n(18,"Harvest Date:"),t(),n(19),S(20,"date"),t(),i(21,"li")(22,"strong"),n(23,"Expiry Date:"),t(),n(24),S(25,"date"),t(),i(26,"li")(27,"strong"),n(28,"Location:"),t(),n(29),t()()()()),a&2){let e=s(2);r(6),C(" ",e.selectedproduct.quantity," ",e.selectedproduct.unit,""),r(5),c("\u20B9",e.selectedproduct.totalPrice,""),r(4),c(" ",e.selectedproduct.status,""),r(4),c(" ",I(20,7,e.selectedproduct.harvestDate),""),r(5),c(" ",I(25,9,e.selectedproduct.expiryDate),""),r(5),c(" ",e.selectedproduct.location,"")}}function oe(a,l){if(a&1&&(i(0,"div")(1,"ul",54)(2,"li")(3,"strong"),n(4,"Storage Condition:"),t(),n(5),t(),i(6,"li")(7,"strong"),n(8,"Packaging Type:"),t(),n(9),t(),i(10,"li")(11,"strong"),n(12,"Certification:"),t(),n(13),t(),i(14,"li")(15,"strong"),n(16,"Farming Type:"),t(),n(17),t(),i(18,"li")(19,"strong"),n(20,"Land Area:"),t(),n(21),t()()()),a&2){let e=s(2);r(5),c(" ",e.selectedproduct.storageCondition,""),r(4),c(" ",e.selectedproduct.packagingType,""),r(4),c(" ",e.selectedproduct.certification,""),r(4),c(" ",e.selectedproduct.farmingType,""),r(4),c(" ",e.selectedproduct.landArea," acres")}}function ae(a,l){if(a&1&&(i(0,"div")(1,"ul",54)(2,"li")(3,"strong"),n(4,"Name:"),t(),n(5),t(),i(6,"li")(7,"strong"),n(8,"Email:"),t(),n(9),t(),i(10,"li")(11,"strong"),n(12,"Phone:"),t(),n(13),t(),i(14,"li")(15,"strong"),n(16,"Address:"),t(),n(17),t(),i(18,"li")(19,"strong"),n(20,"State:"),t(),n(21),t(),i(22,"li")(23,"strong"),n(24,"Postal Code:"),t(),n(25),t()()()),a&2){let e=s(2);r(5),c(" ",e.selectedproduct.farmerName,""),r(4),c(" ",e.selectedproduct.farmerEmail,""),r(4),c(" ",e.selectedproduct.farmerPhone,""),r(4),c(" ",e.selectedproduct.farmerAddress,""),r(4),c(" ",e.selectedproduct.state,""),r(4),c(" ",e.selectedproduct.postalCode,"")}}function le(a,l){if(a&1){let e=w();i(0,"div",56),x("click",function(){u(e);let o=s(2);return g(o.showContactForm=!1)}),t()}}function de(a,l){if(a&1&&(i(0,"div",71),n(1," You are messaging to "),i(2,"strong"),n(3),t()()),a&2){let e=s(3);r(3),b(e.farmermail_for_contact)}}function ce(a,l){if(a&1){let e=w();i(0,"div",57),x("click",function(o){return u(e),g(o.stopPropagation())}),i(1,"div",58)(2,"div",59)(3,"div",60),h(),i(4,"svg",61),p(5,"path",62),t()(),E(),i(6,"h2",63),n(7," \u2709\uFE0F Send Message to Farmer "),t()(),i(8,"button",64),x("click",function(){u(e);let o=s(2);return g(o.showContactForm=!1)}),n(9," \xD7 "),t()(),i(10,"form",65),x("ngSubmit",function(){u(e);let o=s(2);return g(o.sendMessage())}),i(11,"div"),_(12,de,4,1,"div",66),i(13,"textarea",67),D("ngModelChange",function(o){u(e);let f=s(2);return F(f.message.MessageText,o)||(f.message.MessageText=o),g(o)}),t()(),i(14,"button",68),h(),i(15,"svg",69),p(16,"path",70),t(),n(17," Send Message "),t()()()}if(a&2){let e=s(2);r(12),m("ngIf",e.farmermail_for_contact),r(),M("ngModel",e.message.MessageText)}}function se(a,l){if(a&1){let e=w();i(0,"div",12)(1,"div",13)(2,"div",14)(3,"div",15),p(4,"img",16),t(),i(5,"div",17)(6,"div",18)(7,"div",19)(8,"h1",20),n(9),t(),i(10,"span",21),n(11),t()(),i(12,"p",22),n(13),t(),i(14,"div",23)(15,"span",24),n(16),t(),i(17,"span",25),n(18),t(),i(19,"span",26),n(20),t(),i(21,"span",27),n(22),t(),i(23,"span",28),n(24),t()(),i(25,"ul",29),_(26,ne,4,3,"li",30),t(),i(27,"div",31),_(28,re,30,11,"div",32)(29,oe,22,5,"div",32)(30,ae,26,6,"div",32),t(),i(31,"div",33)(32,"div",34),p(33,"i",35),i(34,"span"),n(35,"Listed On:"),t(),i(36,"span",36),n(37),S(38,"date"),t()(),i(39,"div",37),p(40,"i",38),i(41,"span"),n(42,"Last Updated:"),t(),i(43,"span",36),n(44),S(45,"date"),t()()(),i(46,"div",39)(47,"button",40),x("click",function(){u(e);let o=s();return g(o.buyProduct())}),p(48,"i",41),n(49," Buy Now "),t(),i(50,"button",42),x("click",function(){u(e);let o=s();return g(o.toggleContactForm())}),p(51,"i",43),n(52," Contact Farmer "),t(),i(53,"button",44),x("click",function(){u(e);let o=s();return g(o.viewProductPdf(o.selectedproduct.productid))}),p(54,"i",45),n(55," PDF "),t(),i(56,"button",46),x("click",function(){u(e);let o=s();return g(o.goBackToList())}),p(57,"i",47),n(58," Back "),t()()()()()(),_(59,le,1,0,"div",48)(60,ce,18,2,"div",49),t()}if(a&2){let e=s();r(4),m("src",e.selectedproduct.imageUrl||"images/defaultproduct.webp",V)("alt",e.selectedproduct.name),r(5),b(e.selectedproduct.name),r(2),C("\u20B9",e.selectedproduct.pricePerUnit,"/",e.selectedproduct.unit,""),r(2),b(e.selectedproduct.description),r(3),b(e.selectedproduct.category),r(2),b(e.selectedproduct.type),r(2),b(e.selectedproduct.variety),r(2),b(e.selectedproduct.grade),r(),m("ngClass",e.selectedproduct.availability?"bg-green-200 text-green-800":"bg-red-200 text-red-800"),r(),c(" ",e.selectedproduct.availability?"In Stock":"Out of Stock"," "),r(2),m("ngForOf",e.tabs),r(2),m("ngIf",e.activeTab==="overview"),r(),m("ngIf",e.activeTab==="farming"),r(),m("ngIf",e.activeTab==="farmer"),r(7),c(" ",k(38,20,e.selectedproduct.addedDate,"fullDate")," "),r(7),c(" ",k(45,23,e.selectedproduct.updatedDate,"fullDate")," "),r(15),m("ngIf",e.showContactForm),r(),m("ngIf",e.showContactForm)}}var te=class a{constructor(l,e,d,o,f,me,pe,ue){this.productService=l;this.router=e;this.route=d;this.platformId=o;this.alertService=f;this.messageService=me;this.notificationservice=pe;this.userInfo=ue}BASE_URL=Q.BASE_URL;selectedproduct=null;loading=!0;showContactForm=!1;farmermail_for_contact=null;activeTab="overview";message={farmerid:0,BuyerId:0,MessageText:"",RelatedProductId:0};ngOnInit(){this.checkAndLoadData()}checkAndLoadData(){this.route.params.subscribe(l=>{let e=l.productid;e&&this.loadProductDetails(+e)})}loadProductDetails(l){this.loading=!0,this.productService.GetProductById(l).subscribe({next:e=>{this.loading=!1,e.imageUrl!=null&&(console.log("\u{1F4E6} Product details loaded: before",e),e.imageUrl=`${this.BASE_URL}${e.imageUrl}`),this.selectedproduct=e||null,this.farmermail_for_contact=e.farmerEmail||null,console.log("\u{1F4E6} Product details loaded:",this.selectedproduct)},error:e=>{this.loading=!1,this.selectedproduct=null,this.alertService.showAlert("\u274C Error loading product details:",e)}})}sendMessage(){return y(this,null,function*(){yield this.notificationservice.GetUserRole().subscribe({next:l=>y(this,null,function*(){let e=l.data,d=0;if(e.role==="BUYER")d=e.roleid;else if(e.role==="FARMER"){d=e.roleid,yield this.alertService.showAlert("You are a farmer, you cannot send messages to Farmers.","error");return}let o=Number(this.userInfo.getUserId());this.message.BuyerId=o,this.message.farmerid=this.selectedproduct?.userId||0,this.message.RelatedProductId=this.selectedproduct?.productid||0,(yield this.messageService.ContactFarmer(this.message)).subscribe({next:f=>{this.alertService.showAlert("Message sent successfully!","success"),this.message.MessageText=""},error:f=>{this.alertService.showAlert("Error sending message:",f)}})}),error:l=>{this.alertService.showAlert("Error fetching user role:",l)}})})}viewProductPdf(l){this.productService.getProductPdf(l).subscribe({next:e=>{let d=new Blob([e],{type:"application/pdf"}),o=window.URL.createObjectURL(d);window.open(o,"_blank","noopener"),setTimeout(()=>URL.revokeObjectURL(o),5e3)},error:e=>{this.alertService.showAlert("Failed to load PDF:",e),this.alertService.showAlert("unable to open pdf please try again","error")}})}goBackToList(){this.router.navigate(["/products"])}toggleContactForm(){this.showContactForm=!this.showContactForm}buyProduct(){this.router.navigate(["/product-buy"])}tabs=[{id:"overview",label:"Overview",icon:"bi-box-seam"},{id:"farming",label:"Farming",icon:"bi-seedling"},{id:"farmer",label:"Farmer",icon:"bi-person-badge"}];setActiveTab(l){this.activeTab=l}static \u0275fac=function(e){return new(e||a)(v(X),v(N),v(U),v(P),v(J),v(Z),v(ee),v(K))};static \u0275cmp=T({type:a,selectors:[["app-single-product-view"]],decls:2,vars:2,consts:[["class","fixed inset-0 flex items-center justify-center bg-gradient-to-br from-green-900/80 via-black/80 to-green-950/80 backdrop-blur-md z-50",4,"ngIf"],["class","container my-10",4,"ngIf"],[1,"fixed","inset-0","flex","items-center","justify-center","bg-gradient-to-br","from-green-900/80","via-black/80","to-green-950/80","backdrop-blur-md","z-50"],[1,"flex","flex-col","items-center","space-y-8"],[1,"relative"],[1,"w-24","h-24","rounded-full","border-4","border-transparent","border-t-green-400","animate-spin"],[1,"absolute","inset-4","bg-gradient-to-br","from-green-500","to-green-600","rounded-lg","shadow-lg","flex","items-center","justify-center"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"w-8","h-8","text-white","animate-bounce"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M3 7l9-4 9 4-9 4-9-4zM3 17l9 4 9-4M3 12l9 4 9-4"],[1,"text-green-100","text-xl","font-bold","tracking-wide","animate-pulse"],[1,"w-64","h-3","bg-green-900","rounded-full","overflow-hidden","shadow-inner"],[1,"h-full","bg-gradient-to-r","from-green-400","to-green-600","animate-[progressFill_2s_infinite]"],[1,"container","my-10"],[1,"card","shadow-xl","rounded-3xl","overflow-hidden","border-0"],[1,"row","g-0"],[1,"col-md-5"],[1,"img-fluid","h-100","w-100","object-cover",3,"src","alt"],[1,"col-md-7","p-6"],[1,"card-body"],[1,"flex","items-center","justify-between","mb-4"],[1,"text-3xl","font-bold","text-gray-900"],[1,"text-2xl","font-extrabold","text-green-700"],[1,"text-gray-600","mb-4"],[1,"flex","flex-wrap","gap-2","mb-6"],[1,"px-3","py-1","rounded-full","text-sm","bg-blue-100","text-blue-700"],[1,"px-3","py-1","rounded-full","text-sm","bg-purple-100","text-purple-700"],[1,"px-3","py-1","rounded-full","text-sm","bg-indigo-100","text-indigo-700"],[1,"px-3","py-1","rounded-full","text-sm","bg-green-100","text-green-700"],[1,"px-3","py-1","rounded-full","text-sm",3,"ngClass"],[1,"flex","border-b","mb-6"],["class","mr-2",4,"ngFor","ngForOf"],[1,"tab-content","p-3","bg-gray-50","rounded-xl","shadow-sm"],[4,"ngIf"],[1,"mt-6","p-4","rounded-xl","bg-green-50","border","border-green-200","shadow-sm","flex","flex-wrap","items-center","justify-between","text-sm"],[1,"flex","items-center","space-x-2","text-green-700","font-medium"],[1,"bi","bi-calendar-plus"],[1,"text-gray-700","font-normal"],[1,"flex","items-center","space-x-2","text-blue-700","font-medium"],[1,"bi","bi-arrow-repeat"],[1,"flex","flex-wrap","gap-3","mt-5"],[1,"btn","btn-success","flex","items-center","gap-2","px-4","py-2",3,"click"],[1,"bi","bi-cart-check"],[1,"btn","btn-outline-primary","flex","items-center","gap-2","px-4","py-2",3,"click"],[1,"bi","bi-envelope"],[1,"btn","btn-outline-secondary","flex","items-center","gap-2","px-4","py-2",3,"click"],[1,"bi","bi-file-earmark-arrow-down"],[1,"btn","btn-outline-danger","flex","items-center","gap-2","px-4","py-2",3,"click"],[1,"bi","bi-arrow-left"],["class",`fixed inset-0 z-40 flex items-center justify-center 
            bg-gradient-to-br from-black/60 via-green-950/50 to-black/60 
            backdrop-blur-md transition-opacity duration-300 animate-fadeBackdrop`,3,"click",4,"ngIf"],["class",`fixed z-50 top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2
            bg-white rounded-2xl shadow-2xl border border-green-200 max-w-lg w-full
            p-6 transition duration-300 ease-out scale-100 opacity-100`,3,"click",4,"ngIf"],[1,"mr-2"],[1,"inline-flex","items-center","px-5","py-3","rounded-t-xl","font-medium","transition",3,"click","ngClass"],[1,"bi",3,"ngClass"],["id","overview",1,"tab-pane","fade","show","active"],[1,"space-y-2","text-gray-700"],[1,"text-green-700","font-bold"],[1,"fixed","inset-0","z-40","flex","items-center","justify-center","bg-gradient-to-br","from-black/60","via-green-950/50","to-black/60","backdrop-blur-md","transition-opacity","duration-300","animate-fadeBackdrop",3,"click"],[1,"fixed","z-50","top-1/2","left-1/2","transform","-translate-x-1/2","-translate-y-1/2","bg-white","rounded-2xl","shadow-2xl","border","border-green-200","max-w-lg","w-full","p-6","transition","duration-300","ease-out","scale-100","opacity-100",3,"click"],[1,"flex","justify-between","items-center","mb-6","border-b","border-green-100","pb-3","relative"],[1,"flex","items-center","gap-3","animate-slideInLeft"],[1,"bg-green-100","p-2","rounded-full","shadow-sm"],["fill","none","stroke","currentColor","stroke-width","2","viewBox","0 0 24 24",1,"w-6","h-6","text-green-700"],["stroke-linecap","round","stroke-linejoin","round","d","M8 10h.01M12 14h.01M16 10h.01M21 16V8a2 2 0 00-2-2h-3.586a1 1 0 01-.707-.293l-2.414-2.414a1 1 0 00-.707-.293H7a2 2 0 00-2 2v12a2 2 0 002 2h10"],[1,"text-xl","font-bold","text-green-800","tracking-wide"],[1,"absolute","right-0","top-0","text-gray-400","hover:text-red-600","transition-all","text-2xl","font-bold","leading-none","px-2","py-1","rounded-full","hover:bg-red-100",3,"click"],[1,"space-y-4",3,"ngSubmit"],["class","text-sm text-gray-600 bg-gray-100 p-2 rounded-md shadow-sm",4,"ngIf"],["name","MessageText","id","MessageText","placeholder","Write your message to the farmer here...","required","","rows","5",1,"w-full","p-3","rounded-lg","border","border-gray-300","focus:outline-none","focus:ring-2","focus:ring-green-500","transition","shadow-sm",3,"ngModelChange","ngModel"],["type","submit",1,"w-full","flex","justify-center","items-center","gap-2","bg-green-600","text-white","font-semibold","py-2.5","rounded-lg","hover:bg-green-700","transition","duration-300","shadow-md"],["fill","none","stroke","currentColor","stroke-width","2","viewBox","0 0 24 24",1,"w-5","h-5"],["stroke-linecap","round","stroke-linejoin","round","d","M3 8l7.89 5.26a2 2 0 002.22 0L21 8m-18 8h18a2 2 0 002-2V6a2 2 0 00-2-2H3a2 2 0 00-2 2v8a2 2 0 002 2z"],[1,"text-sm","text-gray-600","bg-gray-100","p-2","rounded-md","shadow-sm"]],template:function(e,d){e&1&&_(0,ie,11,0,"div",0)(1,se,61,26,"div",1),e&2&&(m("ngIf",d.loading),r(),m("ngIf",!d.loading&&d.selectedproduct))},dependencies:[L,A,B,j,R,$,q,O,z,G,Y,W,H],styles:["@keyframes _ngcontent-%COMP%_progressFill{0%{width:0%}50%{width:70%}to{width:100%}}"]})};export{te as SingleProductViewComponent};
