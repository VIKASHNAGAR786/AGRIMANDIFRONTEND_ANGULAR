import{l as i}from"./chunk-LO4VKSRB.js";import{u as o}from"./chunk-YLYAE3YR.js";import{V as l,_ as a,za as n}from"./chunk-FFU2WZLN.js";var s=class r{constructor(e,t){this.platformId=e;this.router=t;this.loadFromLocalStorage()}cachedData=null;loadFromLocalStorage(){o(this.platformId)&&(this.cachedData={token:localStorage.getItem("auth_token"),name:localStorage.getItem("user_name"),role:localStorage.getItem("user_role"),email:localStorage.getItem("user_email"),id:this.parseId(localStorage.getItem("nameid")),lang:localStorage.getItem("lang")})}parseId(e){return e?Number(e):null}getToken(){return this.cachedData?.token??null}getUserName(){return this.cachedData?.name??null}getUserRole(){return this.cachedData?.role??null}getUserEmail(){return this.cachedData?.email??null}getUserId(){return this.cachedData?.id??null}getUserLang(){return this.cachedData?.lang??null}changeUserLang(e){this.cachedData&&(this.cachedData.lang=e),localStorage.setItem("lang",e)}decodeToken(e){try{let t=atob(e.split(".")[1]);return JSON.parse(t)}catch{return null}}isLoggedIn(){let e=this.getToken();return!!e&&!this.isTokenExpired(e)}isTokenExpired(e){let t=this.decodeToken(e);if(!t||!t.exp)return!0;let c=t.exp*1e3;return Date.now()>=c}getTokenExpirationDate(e){let t=this.decodeToken(e);return t?.exp?new Date(t.exp*1e3):null}refresh(){this.loadFromLocalStorage()}logout(){o(this.platformId)&&(localStorage.removeItem("auth_token"),localStorage.removeItem("user_name"),localStorage.removeItem("user_role"),localStorage.removeItem("user_email"),localStorage.removeItem("nameid"),localStorage.removeItem("lang")),this.clear(),this.router.navigate(["/auth/login"])}clear(){this.cachedData=null}static \u0275fac=function(t){return new(t||r)(a(n),a(i))};static \u0275prov=l({token:r,factory:r.\u0275fac,providedIn:"root"})};export{s as a};
