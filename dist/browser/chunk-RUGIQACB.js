import{a as te}from"./chunk-NJRBXSK2.js";import{a as ee}from"./chunk-XJ7RQXXD.js";import{b as O,d as z,e as G,g as H,i as W,j as q,r as Y,t as $}from"./chunk-VYT3RLMY.js";import{a as J}from"./chunk-BA2J2MWB.js";import{c as K,d as X}from"./chunk-LKALVNK7.js";import{a as ie}from"./chunk-XQ3L4K6A.js";import{a as Q}from"./chunk-NLJOITTN.js";import{a as Z}from"./chunk-JFGKKBV5.js";import{j as U,l as N}from"./chunk-LO4VKSRB.js";import{k as D,l as A,m as j,q as R,s as L}from"./chunk-YLYAE3YR.js";import{Ab as C,Cb as T,Db as M,Eb as F,Ga as V,Ka as i,Lb as o,Mb as s,Nb as k,Pa as b,Ua as B,Za as S,eb as u,ga as x,ha as v,hb as n,i as I,ia as y,ib as t,ja as E,jb as g,mb as h,pb as f,qb as m,xb as r,yb as w,za as P,zb as a}from"./chunk-FFU2WZLN.js";function re(d,c){d&1&&(n(0,"div",2)(1,"div",3)(2,"div",4),g(3,"div",5),n(4,"div",6),y(),n(5,"svg",7),g(6,"path",8),t()()(),E(),n(7,"p",9),r(8," \u{1F4E6} Loading your inventory... "),t(),n(9,"div",10),g(10,"div",11),t()()())}function ae(d,c){if(d&1){let e=h();n(0,"li",50)(1,"button",51),f("click",function(){let l=x(e).$implicit,_=m(2);return v(_.setActiveTab(l.id))}),g(2,"i",52),r(3),o(4,"translate"),t()()}if(d&2){let e=c.$implicit,p=m(2);i(),u("ngClass",p.activeTab===e.id?"bg-green-100 text-green-700 border-b-2 border-green-600":"text-gray-600 hover:text-green-600 hover:bg-green-50"),i(),u("ngClass",e.icon+" mr-2"),i(),a(" ",s(4,3,e.label)," ")}}function oe(d,c){if(d&1&&(n(0,"div")(1,"div",53)(2,"ul",54)(3,"li")(4,"strong"),r(5),o(6,"translate"),t(),r(7),o(8,"translate"),t(),n(9,"li")(10,"strong"),r(11),o(12,"translate"),t(),n(13,"span",55),r(14),t()(),n(15,"li")(16,"strong"),r(17),o(18,"translate"),t(),r(19),t(),n(20,"li")(21,"strong"),r(22),o(23,"translate"),t(),r(24),o(25,"date"),t(),n(26,"li")(27,"strong"),r(28),o(29,"translate"),t(),r(30),o(31,"date"),t(),n(32,"li")(33,"strong"),r(34),o(35,"translate"),t(),r(36),t()()()()),d&2){let e=m(2);i(5),a("",s(6,13,"Quantity"),":"),i(2),C(" ",e.selectedproduct.quantity," ",s(8,15,e.selectedproduct.unit),""),i(4),a("",s(12,17,"Total Price"),":"),i(3),a("\u20B9",e.selectedproduct.totalPrice,""),i(3),a("",s(18,19,"Status"),":"),i(2),a(" ",e.selectedproduct.status,""),i(3),a("",s(23,21,"Harvest Date"),":"),i(2),a(" ",s(25,23,e.selectedproduct.harvestDate),""),i(4),a("",s(29,25,"Expiry Date"),":"),i(2),a(" ",s(31,27,e.selectedproduct.expiryDate),""),i(4),a("",s(35,29,"Location"),":"),i(2),a(" ",e.selectedproduct.location,"")}}function le(d,c){if(d&1&&(n(0,"div")(1,"ul",54)(2,"li")(3,"strong"),r(4),o(5,"translate"),t(),r(6),t(),n(7,"li")(8,"strong"),r(9),o(10,"translate"),t(),r(11),t(),n(12,"li")(13,"strong"),r(14),o(15,"translate"),t(),r(16),t(),n(17,"li")(18,"strong"),r(19),o(20,"translate"),t(),r(21),t(),n(22,"li")(23,"strong"),r(24),o(25,"translate"),t(),r(26),t()()()),d&2){let e=m(2);i(4),a("",s(5,10,"Storage Condition"),":"),i(2),a(" ",e.selectedproduct.storageCondition,""),i(3),a("",s(10,12,"Packaging Type"),":"),i(2),a(" ",e.selectedproduct.packagingType,""),i(3),a("",s(15,14,"Certification"),":"),i(2),a(" ",e.selectedproduct.certification,""),i(3),a("",s(20,16,"Farming Type"),":"),i(2),a(" ",e.selectedproduct.farmingType,""),i(3),a("",s(25,18,"Land Area"),":"),i(2),a(" ",e.selectedproduct.landArea," acres")}}function de(d,c){if(d&1&&(n(0,"div")(1,"ul",54)(2,"li")(3,"strong"),r(4),o(5,"translate"),t(),r(6),t(),n(7,"li")(8,"strong"),r(9),o(10,"translate"),t(),r(11),t(),n(12,"li")(13,"strong"),r(14),o(15,"translate"),t(),r(16),t(),n(17,"li")(18,"strong"),r(19),o(20,"translate"),t(),r(21),t(),n(22,"li")(23,"strong"),r(24),o(25,"translate"),t(),r(26),t(),n(27,"li")(28,"strong"),r(29),o(30,"translate"),t(),r(31),t()()()),d&2){let e=m(2);i(4),a("",s(5,12,"Name"),":"),i(2),a(" ",e.selectedproduct.farmerName,""),i(3),a("",s(10,14,"Email"),":"),i(2),a(" ",e.selectedproduct.farmerEmail,""),i(3),a("",s(15,16,"Phone"),":"),i(2),a(" ",e.selectedproduct.farmerPhone,""),i(3),a("",s(20,18,"Address"),":"),i(2),a(" ",e.selectedproduct.farmerAddress,""),i(3),a("",s(25,20,"State"),":"),i(2),a(" ",e.selectedproduct.state,""),i(3),a("",s(30,22,"Postal Code"),":"),i(2),a(" ",e.selectedproduct.postalCode,"")}}function se(d,c){if(d&1){let e=h();n(0,"div",56),f("click",function(){x(e);let l=m(2);return v(l.showContactForm=!1)}),t()}}function ce(d,c){if(d&1&&(n(0,"div",71),r(1," You are messaging to "),n(2,"strong"),r(3),t()()),d&2){let e=m(3);i(3),w(e.farmermail_for_contact)}}function pe(d,c){if(d&1){let e=h();n(0,"div",57),f("click",function(l){return x(e),v(l.stopPropagation())}),n(1,"div",58)(2,"div",59)(3,"div",60),y(),n(4,"svg",61),g(5,"path",62),t()(),E(),n(6,"h2",63),r(7," \u2709\uFE0F Send Message to Farmer "),t()(),n(8,"button",64),f("click",function(){x(e);let l=m(2);return v(l.showContactForm=!1)}),r(9," \xD7 "),t()(),n(10,"form",65),f("ngSubmit",function(){x(e);let l=m(2);return v(l.sendMessage())}),n(11,"div"),S(12,ce,4,1,"div",66),n(13,"textarea",67),F("ngModelChange",function(l){x(e);let _=m(2);return M(_.message.MessageText,l)||(_.message.MessageText=l),v(l)}),t()(),n(14,"button",68),y(),n(15,"svg",69),g(16,"path",70),t(),r(17," Send Message "),t()()()}if(d&2){let e=m(2);i(12),u("ngIf",e.farmermail_for_contact),i(),T("ngModel",e.message.MessageText)}}function me(d,c){if(d&1){let e=h();n(0,"div",12)(1,"div",13)(2,"div",14)(3,"div",15),g(4,"img",16),t(),n(5,"div",17)(6,"div",18)(7,"div",19)(8,"h1",20),r(9),t(),n(10,"span",21),r(11),o(12,"translate"),t()(),n(13,"p",22),r(14),t(),n(15,"div",23)(16,"span",24),r(17),o(18,"translate"),t(),n(19,"span",25),r(20),o(21,"translate"),t(),n(22,"span",26),r(23),o(24,"translate"),t(),n(25,"span",27),r(26),o(27,"translate"),t(),n(28,"span",28),r(29),t()(),n(30,"ul",29),S(31,ae,5,5,"li",30),t(),n(32,"div",31),S(33,oe,37,31,"div",32)(34,le,27,20,"div",32)(35,de,32,24,"div",32),t(),n(36,"div",33)(37,"div",34),g(38,"i",35),n(39,"span"),r(40,"Listed On:"),t(),n(41,"span",36),r(42),o(43,"date"),t()(),n(44,"div",37),g(45,"i",38),n(46,"span"),r(47,"Last Updated:"),t(),n(48,"span",36),r(49),o(50,"date"),t()()(),n(51,"div",39)(52,"button",40),f("click",function(){x(e);let l=m();return v(l.buyProduct())}),g(53,"i",41),r(54," Buy Now "),t(),n(55,"button",42),f("click",function(){x(e);let l=m();return v(l.toggleContactForm())}),g(56,"i",43),r(57," Contact Farmer "),t(),n(58,"button",44),f("click",function(){x(e);let l=m();return v(l.viewProductPdf(l.selectedproduct.productid))}),g(59,"i",45),r(60," PDF "),t(),n(61,"button",46),f("click",function(){x(e);let l=m();return v(l.goBackToList())}),g(62,"i",47),r(63," Back "),t()()()()()(),S(64,se,1,0,"div",48)(65,pe,18,2,"div",49),t()}if(d&2){let e=m();i(4),u("src",e.selectedproduct.imageUrl||"images/defaultproduct.webp",V)("alt",e.selectedproduct.name),i(5),w(e.selectedproduct.name),i(2),C("\u20B9",e.selectedproduct.pricePerUnit,"/",s(12,20,e.selectedproduct.unit),""),i(3),w(e.selectedproduct.description),i(3),w(s(18,22,e.selectedproduct.category)),i(3),w(s(21,24,e.selectedproduct.type)),i(3),w(s(24,26,e.selectedproduct.variety)),i(3),w(s(27,28,e.selectedproduct.grade)),i(2),u("ngClass",e.selectedproduct.availability?"bg-green-200 text-green-800":"bg-red-200 text-red-800"),i(),a(" ",e.selectedproduct.availability?"In Stock":"Out of Stock"," "),i(2),u("ngForOf",e.tabs),i(2),u("ngIf",e.activeTab==="overview"),i(),u("ngIf",e.activeTab==="farming"),i(),u("ngIf",e.activeTab==="farmer"),i(7),a(" ",k(43,30,e.selectedproduct.addedDate,"fullDate")," "),i(7),a(" ",k(50,33,e.selectedproduct.updatedDate,"fullDate")," "),i(15),u("ngIf",e.showContactForm),i(),u("ngIf",e.showContactForm)}}var ne=class d{constructor(c,e,p,l,_,ue,ge,xe){this.productService=c;this.router=e;this.route=p;this.platformId=l;this.alertService=_;this.messageService=ue;this.notificationservice=ge;this.userInfo=xe}BASE_URL=Q.BASE_URL;selectedproduct=null;loading=!0;showContactForm=!1;farmermail_for_contact=null;activeTab="overview";message={farmerid:0,BuyerId:0,MessageText:"",RelatedProductId:0};ngOnInit(){this.checkAndLoadData()}checkAndLoadData(){this.route.params.subscribe(c=>{let e=c.productid;e&&this.loadProductDetails(+e)})}loadProductDetails(c){this.loading=!0,this.productService.GetProductById(c).subscribe({next:e=>{this.loading=!1,e.imageUrl!=null&&(console.log("\u{1F4E6} Product details loaded: before",e),e.imageUrl=`${this.BASE_URL}${e.imageUrl}`),this.selectedproduct=e||null,this.farmermail_for_contact=e.farmerEmail||null,console.log("\u{1F4E6} Product details loaded:",this.selectedproduct)},error:e=>{this.loading=!1,this.selectedproduct=null,this.alertService.showAlert("\u274C Error loading product details:",e)}})}sendMessage(){return I(this,null,function*(){yield this.notificationservice.GetUserRole().subscribe({next:c=>I(this,null,function*(){let e=c.data,p=0;if(e.role==="BUYER")p=e.roleid;else if(e.role==="FARMER"){p=e.roleid,yield this.alertService.showAlert("You are a farmer, you cannot send messages to Farmers.","error");return}let l=Number(this.userInfo.getUserId());this.message.BuyerId=l,this.message.farmerid=this.selectedproduct?.userId||0,this.message.RelatedProductId=this.selectedproduct?.productid||0,(yield this.messageService.ContactFarmer(this.message)).subscribe({next:_=>{this.alertService.showAlert("Message sent successfully!","success"),this.message.MessageText=""},error:_=>{this.alertService.showAlert("Error sending message:",_)}})}),error:c=>{this.alertService.showAlert("Error fetching user role:",c)}})})}viewProductPdf(c){this.productService.getProductPdf(c).subscribe({next:e=>{let p=new Blob([e],{type:"application/pdf"}),l=window.URL.createObjectURL(p);window.open(l,"_blank","noopener"),setTimeout(()=>URL.revokeObjectURL(l),5e3)},error:e=>{this.alertService.showAlert("Failed to load PDF:",e),this.alertService.showAlert("unable to open pdf please try again","error")}})}goBackToList(){this.router.navigate(["/products"])}toggleContactForm(){this.showContactForm=!this.showContactForm}buyProduct(){this.router.navigate(["/product-buy"])}tabs=[{id:"overview",label:"Overview",icon:"bi-box-seam"},{id:"farming",label:"Farming",icon:"bi-seedling"},{id:"farmer",label:"Farmer",icon:"bi-person-badge"}];setActiveTab(c){this.activeTab=c}static \u0275fac=function(e){return new(e||d)(b(ee),b(N),b(U),b(P),b(J),b(te),b(ie),b(Z))};static \u0275cmp=B({type:d,selectors:[["app-single-product-view"]],decls:2,vars:2,consts:[["class","fixed inset-0 flex items-center justify-center bg-gradient-to-br from-green-900/80 via-black/80 to-green-950/80 backdrop-blur-md z-50",4,"ngIf"],["class","container my-10",4,"ngIf"],[1,"fixed","inset-0","flex","items-center","justify-center","bg-gradient-to-br","from-green-900/80","via-black/80","to-green-950/80","backdrop-blur-md","z-50"],[1,"flex","flex-col","items-center","space-y-8"],[1,"relative"],[1,"w-24","h-24","rounded-full","border-4","border-transparent","border-t-green-400","animate-spin"],[1,"absolute","inset-4","bg-gradient-to-br","from-green-500","to-green-600","rounded-lg","shadow-lg","flex","items-center","justify-center"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"w-8","h-8","text-white","animate-bounce"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M3 7l9-4 9 4-9 4-9-4zM3 17l9 4 9-4M3 12l9 4 9-4"],[1,"text-green-100","text-xl","font-bold","tracking-wide","animate-pulse"],[1,"w-64","h-3","bg-green-900","rounded-full","overflow-hidden","shadow-inner"],[1,"h-full","bg-gradient-to-r","from-green-400","to-green-600","animate-[progressFill_2s_infinite]"],[1,"container","my-10"],[1,"card","shadow-xl","rounded-3xl","overflow-hidden","border-0"],[1,"row","g-0"],[1,"col-md-5"],[1,"img-fluid","h-100","w-100","object-cover",3,"src","alt"],[1,"col-md-7","p-6"],[1,"card-body"],[1,"flex","items-center","justify-between","mb-4"],[1,"text-3xl","font-bold","text-gray-900"],[1,"text-2xl","font-extrabold","text-green-700"],[1,"text-gray-600","mb-4"],[1,"flex","flex-wrap","gap-2","mb-6"],[1,"px-3","py-1","rounded-full","text-sm","bg-blue-100","text-blue-700"],[1,"px-3","py-1","rounded-full","text-sm","bg-purple-100","text-purple-700"],[1,"px-3","py-1","rounded-full","text-sm","bg-indigo-100","text-indigo-700"],[1,"px-3","py-1","rounded-full","text-sm","bg-green-100","text-green-700"],[1,"px-3","py-1","rounded-full","text-sm",3,"ngClass"],[1,"flex","border-b","mb-6"],["class","mr-2",4,"ngFor","ngForOf"],[1,"tab-content","p-3","bg-gray-50","rounded-xl","shadow-sm"],[4,"ngIf"],[1,"mt-6","p-4","rounded-xl","bg-green-50","border","border-green-200","shadow-sm","flex","flex-wrap","items-center","justify-between","text-sm"],[1,"flex","items-center","space-x-2","text-green-700","font-medium"],[1,"bi","bi-calendar-plus"],[1,"text-gray-700","font-normal"],[1,"flex","items-center","space-x-2","text-blue-700","font-medium"],[1,"bi","bi-arrow-repeat"],[1,"flex","flex-wrap","gap-3","mt-5"],[1,"btn","btn-success","flex","items-center","gap-2","px-4","py-2",3,"click"],[1,"bi","bi-cart-check"],[1,"btn","btn-outline-primary","flex","items-center","gap-2","px-4","py-2",3,"click"],[1,"bi","bi-envelope"],[1,"btn","btn-outline-secondary","flex","items-center","gap-2","px-4","py-2",3,"click"],[1,"bi","bi-file-earmark-arrow-down"],[1,"btn","btn-outline-danger","flex","items-center","gap-2","px-4","py-2",3,"click"],[1,"bi","bi-arrow-left"],["class",`fixed inset-0 z-40 flex items-center justify-center 
            bg-gradient-to-br from-black/60 via-green-950/50 to-black/60 
            backdrop-blur-md transition-opacity duration-300 animate-fadeBackdrop`,3,"click",4,"ngIf"],["class",`fixed z-50 top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2
            bg-white rounded-2xl shadow-2xl border border-green-200 max-w-lg w-full
            p-6 transition duration-300 ease-out scale-100 opacity-100`,3,"click",4,"ngIf"],[1,"mr-2"],[1,"inline-flex","items-center","px-5","py-3","rounded-t-xl","font-medium","transition",3,"click","ngClass"],[1,"bi",3,"ngClass"],["id","overview",1,"tab-pane","fade","show","active"],[1,"space-y-2","text-gray-700"],[1,"text-green-700","font-bold"],[1,"fixed","inset-0","z-40","flex","items-center","justify-center","bg-gradient-to-br","from-black/60","via-green-950/50","to-black/60","backdrop-blur-md","transition-opacity","duration-300","animate-fadeBackdrop",3,"click"],[1,"fixed","z-50","top-1/2","left-1/2","transform","-translate-x-1/2","-translate-y-1/2","bg-white","rounded-2xl","shadow-2xl","border","border-green-200","max-w-lg","w-full","p-6","transition","duration-300","ease-out","scale-100","opacity-100",3,"click"],[1,"flex","justify-between","items-center","mb-6","border-b","border-green-100","pb-3","relative"],[1,"flex","items-center","gap-3","animate-slideInLeft"],[1,"bg-green-100","p-2","rounded-full","shadow-sm"],["fill","none","stroke","currentColor","stroke-width","2","viewBox","0 0 24 24",1,"w-6","h-6","text-green-700"],["stroke-linecap","round","stroke-linejoin","round","d","M8 10h.01M12 14h.01M16 10h.01M21 16V8a2 2 0 00-2-2h-3.586a1 1 0 01-.707-.293l-2.414-2.414a1 1 0 00-.707-.293H7a2 2 0 00-2 2v12a2 2 0 002 2h10"],[1,"text-xl","font-bold","text-green-800","tracking-wide"],[1,"absolute","right-0","top-0","text-gray-400","hover:text-red-600","transition-all","text-2xl","font-bold","leading-none","px-2","py-1","rounded-full","hover:bg-red-100",3,"click"],[1,"space-y-4",3,"ngSubmit"],["class","text-sm text-gray-600 bg-gray-100 p-2 rounded-md shadow-sm",4,"ngIf"],["name","MessageText","id","MessageText","placeholder","Write your message to the farmer here...","required","","rows","5",1,"w-full","p-3","rounded-lg","border","border-gray-300","focus:outline-none","focus:ring-2","focus:ring-green-500","transition","shadow-sm",3,"ngModelChange","ngModel"],["type","submit",1,"w-full","flex","justify-center","items-center","gap-2","bg-green-600","text-white","font-semibold","py-2.5","rounded-lg","hover:bg-green-700","transition","duration-300","shadow-md"],["fill","none","stroke","currentColor","stroke-width","2","viewBox","0 0 24 24",1,"w-5","h-5"],["stroke-linecap","round","stroke-linejoin","round","d","M3 8l7.89 5.26a2 2 0 002.22 0L21 8m-18 8h18a2 2 0 002-2V6a2 2 0 00-2-2H3a2 2 0 00-2 2v8a2 2 0 002 2z"],[1,"text-sm","text-gray-600","bg-gray-100","p-2","rounded-md","shadow-sm"]],template:function(e,p){e&1&&S(0,re,11,0,"div",0)(1,me,66,36,"div",1),e&2&&(u("ngIf",p.loading),i(),u("ngIf",!p.loading&&p.selectedproduct))},dependencies:[L,D,A,j,R,$,q,O,z,G,Y,W,H,X,K],styles:["@keyframes _ngcontent-%COMP%_progressFill{0%{width:0%}50%{width:70%}to{width:100%}}"]})};export{ne as SingleProductViewComponent};
